function soGoogleMapInitialize(){new sowb.SiteOriginGoogleMap(jQuery).initMaps()}window.sowb=window.sowb||{},sowb.SiteOriginGoogleMapInstances=[],sowb.SiteOriginGoogleMap=function(o){return{DEFAULT_LOCATIONS:["Addo Elephant National Park, R335, Addo","Cape Town, Western Cape, South Africa","San Francisco Bay Area, CA, United States","New York, NY, United States"],showMap:function(o,e,t){var a=Number(t.zoom);a||(a=14),window.matchMedia("(max-width: "+t.breakpoint+"px)").matches&&(a=t.mobileZoom);var i,s={zoom:a,gestureHandling:t.gestureHandling,disableDefaultUI:t.disableUi,zoomControl:t.zoomControl,panControl:t.panControl,center:e,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,"user_map_style"]}},n=new google.maps.Map(o,s),r={name:t.mapName},l=t.mapStyles;if(l){var g=new google.maps.StyledMapType(l,r);n.mapTypes.set("user_map_style",g),n.setMapTypeId("user_map_style")}(t.markerAtCenter&&(this.centerMarker=new google.maps.Marker({position:e,map:n,draggable:t.markersDraggable,icon:t.markerIcon,title:""}),n.centerMarker=this.centerMarker),t.keepCentered)&&(google.maps.event.addDomListener(n,"idle",(function(){i=n.getCenter()})),google.maps.event.addDomListener(window,"resize",(function(){n.setCenter(i)})));this.linkAutocompleteField(t.autocomplete,t.autocompleteElement,n,t),this.showMarkers(t.markerPositions,n,t),this.showDirections(t.directions,n,t),sowb.SiteOriginGoogleMapInstances.push(n)},linkAutocompleteField:function(e,t,a,i){if(e&&t){var s=function(o){this.inputAddress!==o&&(this.inputAddress=o,this.getLocation(this.inputAddress).done(function(o){a.setZoom(15),a.setCenter(o),this.centerMarker&&(this.centerMarker.setPosition(o),this.centerMarker.setTitle(this.inputAddress))}.bind(this)))}.bind(this),n=o(t);e.addListener("place_changed",function(){var o=e.getPlace();a.setZoom(15),o.geometry&&(a.setCenter(o.geometry.location),this.centerMarker&&this.centerMarker.setPosition(o.geometry.location))}.bind(this)),google.maps.event.addDomListener(t,"keypress",(function(o){"13"===(o.keyCode||o.which)&&o.preventDefault()})),n.on("focusin",function(){if(!this.resultsObserver){var e=document.querySelector(".pac-container");this.resultsObserver=new MutationObserver((function(){var e=o(o(".pac-item").get(0)),t=e.find(".pac-item-query").text(),a=e.find("span").not("[class]").text(),i=t+(a?", "+a:"");i&&s(i)}));this.resultsObserver.observe(e,{attributes:!0,childList:!0,characterData:!0})}}.bind(this));var r=function(o){this.getGeocoder().geocode({location:o},function(e,t){if(t===google.maps.GeocoderStatus.OK&&e.length>0){var a=e[0].formatted_address;n.val(a),this.centerMarker&&(this.centerMarker.setPosition(o),this.centerMarker.setTitle(a))}}.bind(this))}.bind(this);a.addListener("click",(function(o){r(o.latLng)})),this.centerMarker.addListener("dragend",(function(o){r(o.latLng)}))}},showMarkers:function(o,e,t){if(o&&o.length){this.infoWindows=[];for(var a=[],i=0;i<o.length;i++){var s=parseInt(i/10);a.length===s&&(a[s]=[]),a[s][i%10]=o[i]}var n=function(o){var a=o.customMarkerIcon,i=o.hasOwnProperty("info")?o.info:null,s=o.hasOwnProperty("infoMaxWidth")?o.infoMaxWidth:null;return this.getLocation(o.place).done(function(o){var n=t.markerIcon;a&&(n=a);var r=new google.maps.Marker({position:o,map:e,draggable:t.markersDraggable,icon:n,title:""});if(i){var l={content:i};s&&(l.maxWidth=s);var g=t.markerInfoDisplay;l.disableAutoPan="always"===g;var p=new google.maps.InfoWindow(l);this.infoWindows.push(p);var c=g;"always"===g&&(c="click",p.open({map:e,anchor:r,shouldFocus:!1})),r.addListener(c,function(){p.open(e,r),"always"===g||t.markerInfoMultiple||this.infoWindows.forEach((function(o){o!==p&&o.close()}))}.bind(this)),"mouseover"===g&&r.addListener("mouseout",(function(){setTimeout((function(){p.close()}),100)}))}}.bind(this)).fail((function(o){r=o===google.maps.GeocoderStatus.OVER_QUERY_LIMIT,console.log(o)}))}.bind(this),r=!1,l=function(o,e){for(var t=0,a=0;a<o.length&&!r;a++)n(o[a]).then((function(){++t===o.length&&e.length&&l(e.shift(),e)}))}.bind(this);l(a.shift(),a)}},showDirections:function(o,e){if(o){o.waypoints&&o.waypoints.length&&o.waypoints.map((function(o){o.stopover=Boolean(o.stopover)}));var t=new google.maps.DirectionsRenderer;t.setMap(e),(new google.maps.DirectionsService).route({origin:o.origin,destination:o.destination,travelMode:o.travelMode.toUpperCase(),avoidHighways:o.avoidHighways,avoidTolls:o.avoidTolls,waypoints:o.waypoints,optimizeWaypoints:o.optimizeWaypoints},(function(e,a){a===google.maps.DirectionsStatus.OK&&(t.setOptions({preserveViewport:o.preserveViewport}),t.setDirections(e))}))}},initMaps:function(){var e=o(".sow-google-map-autocomplete"),t=new o.Deferred;0===e.length?t.resolve():e.each(function(e,a){if(void 0!==google.maps.places){var i=new google.maps.places.Autocomplete(a),s=o(a).siblings(".sow-google-map-canvas");if(s.length>0){var n=s.data("options");n.autocomplete=i,n.autocompleteElement=a,this.getLocation(n.address).done(function(o){this.showMap(s.get(0),o,n),s.data("initialized",!0),t.resolve()}.bind(this)).fail((function(){s.append("<div><p><strong>"+soWidgetsGoogleMap.geocode.noResults+"</strong></p></div>"),t.reject()}))}}else t.reject('Sorry, we couldn\'t load the "places" library due to another plugin, so the autocomplete feature is not available.')}.bind(this)),t.always(function(){o(".sow-google-map-canvas").each(function(e,t){var a=o(t);if(a.data("initialized"))return!0;var i=a.data("options"),s=i.address;if(!s){var n=i.markerPositions;n&&n.length&&(s=n[0].place)}this.getLocation(s).done(function(o){this.showMap(a.get(0),o,i),a.data("initialized",!0)}.bind(this)).fail((function(){a.append("<div><p><strong>"+soWidgetsGoogleMap.geocode.noResults+"</strong></p></div>")}))}.bind(this))}.bind(this)).fail((function(o){console.log(o)})).done((function(){o(sowb).trigger("maps_loaded")}))},getGeocoder:function(){return this._geocoder||(this._geocoder=new google.maps.Geocoder),this._geocoder},getLocation:function(e){var t,a=new o.Deferred,i={address:e};if(e&&e.indexOf(",")>-1){var s=e.replace(/[\(\)]/g,"").split(",");s&&2===s.length&&(t=new google.maps.LatLng(s[0],s[1]),isNaN(t.lat())||isNaN(t.lng())||(i={location:{lat:t.lat(),lng:t.lng()}}))}if(i.hasOwnProperty("location"))a.resolve(i.location);else if(i.hasOwnProperty("address")){if(!i.address){var n=parseInt(Math.random()*this.DEFAULT_LOCATIONS.length);i.address=this.DEFAULT_LOCATIONS[n]}var r=0,l=function(o,e){e===google.maps.GeocoderStatus.OK?a.resolve(o[0].geometry.location):e===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?++r<3?setTimeout(function(){this.getGeocoder().geocode.call(this,i,l)}.bind(this),1e3):a.reject(e):e!==google.maps.GeocoderStatus.ZERO_RESULTS&&e!==google.maps.GeocoderStatus.OVER_DAILY_LIMIT||a.reject(e)}.bind(this);this.getGeocoder().geocode(i,l)}return a}}},jQuery((function(o){sowb.googleMapsData=[],sowb.googleMapsData.libraries=[],sowb.setupGoogleMaps=function(e,t=!1){var a=o(".sow-google-map-canvas");a.length&&(a.each((function(e,t){var a=o(t);if(a.data("apiInitialized"))return a;var i=a.data("options");i&&(void 0!==i.libraries&&null!==i.libraries&&(sowb.googleMapsData.libraries=sowb.googleMapsData.libraries.concat(i.libraries)),!sowb.googleMapsData.apiKey&&i.apiKey&&(sowb.googleMapsData.apiKey=i.apiKey)),a.data("apiInitialized",!0)})),void 0===window.google&&(window.google={}),(t||void 0===window.google||void 0===window.google.maps)&&(sowb.loadGoogleMapsAPI(t),sowb.googleMapsData.timer=setInterval((function(){var o=!1;sowb.googleMapsData.ApiError=!0,void 0!==sowb.googleMapsData.ApiError&&sowb.googleMapsData.ApiError&&(o=!0),o||void 0===window.google||void 0===window.google.maps||(o=!0,soGoogleMapInitialize()),o&&clearInterval(sowb.googleMapsData.timer)}),250)))},sowb.loadGoogleMapsAPI=function(e=!1){o("#sow-google-maps-js").length&&(e||void 0!==sowb.googleMapsData.ApiError&&sowb.googleMapsData.ApiError)&&o("#sow-google-maps-js").remove(),sowb.googleMapsData.apiKey||console.warn("SiteOrigin Google Maps: Could not find API key. Google Maps API key is required.");var t="https://maps.googleapis.com/maps/api/js?key="+sowb.googleMapsData.apiKey+"&callback=soGoogleMapInitialize";if(sowb.googleMapsData.libraries&&sowb.googleMapsData.libraries.length&&(t+="&libraries="+sowb.googleMapsData.libraries.join(",")),window.console&&window.console.error){var a=window.console.error;sowb.googleMapsData.ApiError=!1,sowb.onLoadMapsApiError=function(e){var t;"string"==typeof e&&(t=e.match(/^Google Maps API (error|warning): ([^\s]*)\s([^\s]*)(?:\s(.*))?/)),t&&t.length&&t[0]&&(o(".sow-google-map-canvas").each((function(e,t){var a=o(t);if(a.data("fallbackImage")){var i=a.data("fallbackImage");i.hasOwnProperty("img")&&a.append(i.img)}})),sowb.googleMapsData.ApiError=!0),a.apply(window.console,arguments)},window.console.error=sowb.onLoadMapsApiError}soWidgetsGoogleMap.map_consent?(e&&o(".sow-google-map-consent button").off("click"),o(".sow-google-map-consent button").on("click",(function(){o(".sow-google-map-consent").remove(),o(".sow-google-map-canvas").show(),o("body").append('<script async type="text/javascript" id="sow-google-maps-js" src="'+t+'">'),sowb.mapsApiInitialized=!0}))):(o("body").append('<script async type="text/javascript" id="sow-google-maps-js" src="'+t+'">'),sowb.mapsApiInitialized=!0)},sowb.setupGoogleMaps(),o(sowb).on("setup_widgets",sowb.setupGoogleMaps)}));
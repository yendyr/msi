var sowb=window.sowb||{};jQuery((function(i){sowb.setupCarousel=function(){i.fn.setSlideTo=function(e){$item=i(this);var s=$item.slick("slickGetOption","slidesToShow"),t=$item.slick("slickGetOption","slidesToScroll");$item.slick("slickSetOption","slidesToShow",1),$item.slick("slickSetOption","slidesToScroll",1),$item.slick("slickGoTo",e),$item.slick("slickSetOption","slidesToShow",s),$item.slick("slickSetOption","slidesToScroll",t)},i(".sow-carousel-wrapper").each((function(){var e=i(this),s=e.find(".sow-carousel-items"),t=e.data("responsive"),o=e.data("carousel_settings");s.not(".slick-initialized").slick({arrows:!1,dots:o.dots,rows:0,rtl:"rtl"==e.data("dir"),touchThreshold:20,infinite:!e.data("ajax-url")&&e.data("carousel_settings").loop,variableWidth:e.data("variable_width"),accessibility:!1,speed:o.animation_speed,autoplay:o.autoplay,autoplaySpeed:o.autoplaySpeed,pauseOnHover:o.pauseOnHover,slidesToScroll:t.desktop_slides,slidesToShow:t.desktop_slides,responsive:[{breakpoint:t.tablet_portrait_breakpoint,settings:{slidesToScroll:t.tablet_portrait_slides,slidesToShow:t.tablet_portrait_slides}},{breakpoint:t.mobile_breakpoint,settings:{slidesToScroll:t.mobile_slides,slidesToShow:t.mobile_slides}}]}),o.item_overflow&&(s.css("width",""),s.css("opacity","")),s.on("swipe",(function(i,s,t){e.parent().parent().find(".sow-carousel-"+("left"==t?"next":"prev")).trigger("touchend")})),e.parent().parent().find(".sow-carousel-previous, .sow-carousel-next").on("click touchend",(function(s,t){s.preventDefault();var o=e.find(".sow-carousel-items"),l=o.find(".sow-carousel-item").length,a=l>=e.data("item_count"),c=Math.ceil(o.outerWidth()/o.find(".sow-carousel-item").outerWidth(!0)),n=o.slick("slickGetOption","slidesToScroll"),r=l-c;"post"==e.data("widget")&&r++,a||(o.slick("slickCurrentSlide")+c>=l-1||o.slick("slickCurrentSlide")+n>r)&&i(sowb).trigger("carousel_load_new_items",[e,o,t]),i(this).hasClass("sow-carousel-next")?a&&o.slick("slickCurrentSlide")>=r?e.data("carousel_settings").loop&&o.slick("slickGoTo",0):o.slick("slickCurrentSlide")+n>r?o.setSlideTo(r):o.slick("slickNext"):i(this).hasClass("sow-carousel-previous")&&(e.data("carousel_settings").loop&&0==o.slick("slickCurrentSlide")?o.slick("slickGoTo",r):o.slick("slickPrev"))})),o.dots&&e.data("variable_width")&&(e.find(".slick-dots li").off("click.slick"),e.find(".slick-dots li").on("click touchend",(function(){var e=i(this).index(),t=s.find(".sow-carousel-item").length,o=Math.ceil(s.outerWidth()/s.find(".sow-carousel-item").outerWidth(!0)),l=t-o;e+o>=t?(s.slick("slickGoTo",l),$dots=i(this).parent(),$dots.find(".slick-active").removeClass("slick-active"),$dots.children().eq(e).addClass("slick-active")):s.slick("slickGoTo",e)})))})),i(sowb).trigger("carousel_setup"),i(document).on("keydown",".sow-carousel-navigation a",(function(e){13!=e.keyCode&&32!=e.keyCode||(e.preventDefault(),i(this).trigger("click"))})),i(document).on("keyup",".sow-carousel-item",(function(e){if(13==e.keyCode&&i(this).find("h3 a")[0].click(),37==e.keyCode||39==e.keyCode){var s=i(this).parents(".sow-carousel-wrapper"),t=s.find(".sow-carousel-items"),o=t.find(".sow-carousel-item").length,l=i(this).data("slick-index"),a=o-(o===s.data("item_count")?0:1);if(37==e.keyCode)--l<0&&(l=a);else if(39==e.keyCode&&++l>=a){if(s.data("fetching"))return;s.parent().find(".sow-carousel-next").trigger("click",!0)}t.slick("slickGoTo",l,!0),s.find(".sow-carousel-item").prop("tabindex",-1),s.find('.sow-carousel-item[data-slick-index="'+l+'"]').trigger("focus").prop("tabindex",0)}})),i(window).on("resize load",(function(){i(".sow-carousel-wrapper").each((function(){var e=i(this),s=e.find(".sow-carousel-items.slick-initialized"),t=Math.ceil(s.outerWidth()/s.find(".sow-carousel-item").outerWidth(!0)),o=e.parent().parent().find(".sow-carousel-navigation");t>=e.data("item_count")?(o.hide(),s.slick("slickSetOption","touchMove",!1),s.slick("slickSetOption","draggable",!1)):o.not(":visible")&&(o.show(),s.slick("slickSetOption","touchMove",!0),s.slick("slickSetOption","draggable",!0));var l=e.data("responsive");window.matchMedia("(min-width: "+l.tablet_portrait_breakpoint+"px) and (max-width: "+l.tablet_landscape_breakpoint+"px) and (orientation: landscape)").matches&&(s.slick("slickSetOption","slidesToShow",l.tablet_landscape_slides),s.slick("slickSetOption","slidesToScroll",l.tablet_landscape_slides))})),i(".sow-carousel-item:first-of-type").prop("tabindex",0)}))},sowb.setupCarousel(),i(sowb).on("setup_widgets",sowb.setupCarousel)})),window.sowb=sowb;